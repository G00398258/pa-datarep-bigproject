<html lang="en">
    <head>
        <!-- AJAX JQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <!-- CSS only -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        
        <!-- https://forum.freecodecamp.org/t/space-between-radio-button-and-the-word/493595 -->
        <style>
            .radiobtn {
                margin-left:10px; margin-right:10px;
            }
            /* using Dell blue for the background on headings */
            h1{
                background-color: #3287c1;
                height: 80;
                padding: 15;
                color: white
            }
            h2{
                
                background-color: #3287c1;
                height: 80;
                padding: 20;
                color: white
            }
            tr:hover {
                background-color: #A9CCE3;
            }

        </style>
        <title>IT Pulse Survey</title>
    </head>

    <body>
        <div id="welcome">
            <h1> IT Pulse Survey </h1>
            <h4> Welcome to the IT Pulse Survey!</h4>
            <p>In our efforts to improve your overall IT experience, we are taking a quick survey to understand what is working well and what could be improved in the IT space.</p>
            <p>To begin, please click the <b>Take Survey</b> button below.<p>
            <button id="showSurveyButton" onclick="showCreate()">Take Survey</button>
            <br>
            <p> To view the current survey results or statistics, please click the relevant button below.</p>
        </div>

        <div id="resultsStatsButtons" style="display:inline-block">
            <p><button id="showResultsButton" onclick="showResults()">View Results</button>
            <button id="showStatsButton" onclick="showStatistics()">View Statistics</button></p>
            <br>
            <p><a href="goodbye.html">Exit</a></p>
            <br>
            
        </div>

        <div id="createForm" style="display:none">
            <h1>Please Enter Your Survey Responses Below</h1>
            <input type="hidden" name="id"/>
            <p>Please enter your Employee ID: <br>
            <input type="number" name="employeeID"/></p>
            <p>On a scale of 1-10, how would you rate your overall IT experience? <br>
            <img src="images/scale.png" title = "Score Scale" alt = "Picture: Colour and sentiment scale" hspace="5" width = "470" height="33"> <br>
            <input class="radiobtn" type="radio" name="overallIT" value="1">1
            <input class="radiobtn" type="radio" name="overallIT" value="2">2
            <input class="radiobtn" type="radio" name="overallIT" value="3">3
            <input class="radiobtn" type="radio" name="overallIT" value="4">4
            <input class="radiobtn" type="radio" name="overallIT" value="5">5
            <input class="radiobtn" type="radio" name="overallIT" value="6">6
            <input class="radiobtn" type="radio" name="overallIT" value="7">7
            <input class="radiobtn" type="radio" name="overallIT" value="8">8
            <input class="radiobtn" type="radio" name="overallIT" value="9">9
            <input class="radiobtn" type="radio" name="overallIT" value="10">10
            </p>

            <p>On a scale of 1-10, how satisfied are you with your Dell laptop? <br>
            <img src="images/scale.png" title = "Score Scale" alt = "Picture: Colour and sentiment scale" hspace="5" width = "470" height="33"> <br>
            <input class="radiobtn" type="radio" name="laptop" value="1">1
            <input class="radiobtn" type="radio" name="laptop" value="2">2
            <input class="radiobtn" type="radio" name="laptop" value="3">3
            <input class="radiobtn" type="radio" name="laptop" value="4">4
            <input class="radiobtn" type="radio" name="laptop" value="5">5
            <input class="radiobtn" type="radio" name="laptop" value="6">6
            <input class="radiobtn" type="radio" name="laptop" value="7">7
            <input class="radiobtn" type="radio" name="laptop" value="8">8
            <input class="radiobtn" type="radio" name="laptop" value="9">9
            <input class="radiobtn" type="radio" name="laptop" value="10">10
            </p>
        
            <p>On a scale of 1-10, how would you rate your Dell issued accessories and peripherals (monitors, headsets, keyboards, etc.)? <br>
            <img src="images/scale.png" title = "Score Scale" alt = "Picture: Colour and sentiment scale" hspace="5" width = "470" height="33"> <br>
            <input class="radiobtn" type="radio" name="accessories" value="1">1
            <input class="radiobtn" type="radio" name="accessories" value="2">2
            <input class="radiobtn" type="radio" name="accessories" value="3">3
            <input class="radiobtn" type="radio" name="accessories" value="4">4
            <input class="radiobtn" type="radio" name="accessories" value="5">5
            <input class="radiobtn" type="radio" name="accessories" value="6">6
            <input class="radiobtn" type="radio" name="accessories" value="7">7
            <input class="radiobtn" type="radio" name="accessories" value="8">8
            <input class="radiobtn" type="radio" name="accessories" value="9">9
            <input class="radiobtn" type="radio" name="accessories" value="10">10
            </p>

            <p>On a scale of 1-10, how would you rate the applications you use for your role? <br>
            <img src="images/scale.png" title = "Score Scale" alt = "Picture: Colour and sentiment scale" hspace="5" width = "470" height="33"> <br>
        
            <input class="radiobtn" type="radio" name="apps" value="1">1
            <input class="radiobtn" type="radio" name="apps" value="2">2
            <input class="radiobtn" type="radio" name="apps" value="3">3
            <input class="radiobtn" type="radio" name="apps" value="4">4
            <input class="radiobtn" type="radio" name="apps" value="5">5
            <input class="radiobtn" type="radio" name="apps" value="6">6
            <input class="radiobtn" type="radio" name="apps" value="7">7
            <input class="radiobtn" type="radio" name="apps" value="8">8
            <input class="radiobtn" type="radio" name="apps" value="9">9
            <input class="radiobtn" type="radio" name="apps" value="10">10
            </p>
    
            <p>On a scale of 1-10, how would you rate the IT Support available to you (via phone, chat, service desk and onsite)? <br>
            <img src="images/scale.png" title = "Score Scale" alt = "Picture: Colour and sentiment scale" hspace="5" width = "470" height="33"> <br>
            
            <input class="radiobtn" type="radio" name="support" value="1">1
            <input class="radiobtn" type="radio" name="support" value="2">2
            <input class="radiobtn" type="radio" name="support" value="3">3
            <input class="radiobtn" type="radio" name="support" value="4">4
            <input class="radiobtn" type="radio" name="support" value="5">5
            <input class="radiobtn" type="radio" name="support" value="6">6
            <input class="radiobtn" type="radio" name="support" value="7">7
            <input class="radiobtn" type="radio" name="support" value="8">8
            <input class="radiobtn" type="radio" name="support" value="9">9
            <input class="radiobtn" type="radio" name="support" value="10">10
            </p>
            
            <p>What's going well? Please enter any positive feedback you have to share <br>
            <textarea name="posFeedback" rows="6" cols="70">
                </textarea> </p>
            
            <p>
            What could be improved? Please enter any negative feedback you have to share <br>
            <textarea name="negFeedback" rows="6" cols="70">
                </textarea> </p>
            
            <p>Finally, do you consent to having your contact information shared with stakeholders for follow up post survey? <br>
                <input class="radiobtn" type="radio" name="followUp" value="Yes">Yes
                <input class="radiobtn" type="radio" name="followUp" value="No">No
            </p>
    
            <p><button id="doCreateUpdateButton" onclick="doCreateUpdate()">Submit</button></p>
            <br>
            <p><a href="goodbye.html">Exit</a></p>
        </div>

        <div id="thankyou" style="display:none">
            <h1>Thank you for completing the IT Pulse Survey!</h1>
            <!-- Response ID and a message will be entered in here by the DOM -->
            <p id="respID"></p>
            <p> To view the current survey results or statistics, please click the relevant button below.</p>
            <br>
            <p><button id="showResultsButton" onclick="showResults()">View Results</button>
            <button id="showStatsButton" onclick="showStatistics()">View Statistics</button></p>
            <br>
            <p>To review, update or delete your response, please click the button below.</p>
            <br>
            <p><button id="updateDeleteButton" onclick="showUpdateDelete()">Review Your Response</button></p>
            <br>
            <p><a href="goodbye.html">Exit</a></p>
            <br>
        </div>

        <div id="updateDelete" style="display:none">
            <h1 id="heading">Review Survey Response</h1>
            <p>Please enter your Response ID: <br>
                <input type="number" name="respID"></p>
                <br>
                <button id="retrieveButton" onclick="retrieveRecord()">View Survey Response</button>
                
            </table>
            <br>

        </div>

        <div id="results" style="display:none">
            <h1>Current Survey Results</h1>
            <table class="table" id="resultsTable" style="border-bottom: 1px solid #ddd;">
                <thead> 
                        <th>Response ID</th>
                        <th>Overall IT</th>
                        <th>Laptops</th>
                        <th>Accessories</th>
                        <th>Applications</th>
                        <th>Support</th>
                        <th>Positive Feedback</th>
                        <th>Negative Feedback</th>
                        <th>Follow Up</th>
                </thead>
                
            </table>
            <br>

        </div>

        <div id="updateDeleteButtons" style="display:none">
            <!-- Employee ID will be inserted here-->
            <h5 id="empID"></h5>
            <br>
            <button id="updateButton" onclick="updateRecord()">Update Response</button>
            <button id="deleteButton" onclick="warnUser()">Delete Response</button>
            <br>
            <p><h3 id="warnUser" style="display:none">WARNING: You are about to delete your response</h3></p>
            <button id="confirmButton" style="display:none" onclick="deleteRecord()">Confirm Delete</button>
            <br>
            <p><a href="goodbye.html">Exit</a></p>
            <br>
        </div>

        <div id="deleted" style="display:none">
            <h3>Response has been deleted</h3>
            <p> To view the current survey results, please click the button below.</p>
            <button id="showResultsButton" onclick="showResults()">View Results</button>
            <button id="showStatsButton" onclick="showStatistics()">View Statistics</button>
            <br>
        </div>
        
        <div id="surveyStats" style="display:none">
            <h1>Survey Statistics</h1>
            <!-- Number of survey responses will be inserted here -->
            <h3 id="numResponses"></h3>
            <br>
            <h2>Average Scores</h2>
            <table class="table" id="scoresTable" style="border-bottom: 1px solid #ddd;">
                <thead> 
                        <th>Overall IT</th>
                        <th>Laptops</th>
                        <th>Accessories</th>
                        <th>Applications</th>
                        <th>Support</th>
                </thead>
            </table>
            <br>
            <h2>Responses By Department</h2>
            <table class="table" id="deptsTable" style="border-bottom: 1px solid #ddd;">
                <thead> 
                        <th>Department</th>
                        <th>No. Responses</th>
                </thead>
            </table>
            <br>
            <h2>Laptop Models Scoring Negatively</h2>
            <table class="table" id="laptopsTable" style="border-bottom: 1px solid #ddd;">
                <thead> 
                        <th>Model</th>
                        <th>Negative Scores</th>
                </thead>
            </table>
            <br>
            <h2>Open to Follow Up: Employee Info & Scores</h2>
            <table class="table" id="fupTable" style="border-bottom: 1px solid #ddd;">
                <thead> 
                    <th>Response ID</th>
                    <th>Employee ID</th>
                    <th>Email</th>
                    <th>Manager ID</th>
                    <th>Location</th>
                    <th>Job Title</th>
                    <th>Department</th>
                    <th>Laptop Model</th>
                    <th>Laptop Age (mths)</th>
                    <th>Follow Up</th>
                    <th>Overall IT</th>
                    <th>Laptops</th>
                    <th>Accessories</th>
                    <th>Applications</th>
                    <th>Support</th>
                </thead>
            </table>
            <br>

        </div>

        


    </body>

    <script>

        function showCreate(){
            document.getElementById('welcome').style.display="none";
            document.getElementById('createForm').style.display="inline-block";
            document.getElementById('results').style.display="none";
            document.getElementById('surveyStats').style.display="none";
            document.getElementById('resultsStatsButtons').style.display="none";


        }

        function doCreateUpdate(){
            var form = document.getElementById('createForm')
            var record = {}
            record.EmployeeID = form.querySelector('input[name="employeeID"]').value
            
            //code below adapted from: https://www.geeksforgeeks.org/how-to-get-value-of-selected-radio-button-using-javascript/
            var ele = document.getElementsByName('overallIT');
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                    record.IT_Overall_Score = ele[i].value;}
            var ele = document.getElementsByName('laptop');
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                    record.Laptop_Score = ele[i].value;}
            var ele = document.getElementsByName('accessories');
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                    record.Accessories_Score = ele[i].value;}
            var ele = document.getElementsByName('apps');
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                    record.Applications_Score = ele[i].value;}
            var ele = document.getElementsByName('support');
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                    record.Support_Score = ele[i].value;}
            
            record.Positive_Feedback = form.querySelector('textarea[name="posFeedback"]').value
            record.Negative_Feedback = form.querySelector('textarea[name="negFeedback"]').value
            
            var ele = document.getElementsByName('followUp');
            for(i = 0; i < ele.length; i++) {
                if(ele[i].checked)
                    record.Follow_Up = ele[i].value;}

            console.log(JSON.stringify(record))

            //if employee ID field is disabled, then we're doing an update, not a create
            //https://bobbyhadz.com/blog/javascript-check-if-element-is-disabled
            if (form.querySelector('input[name="employeeID"]').disabled) {
                updateRecordAjax(record);
            } else {
                createRecordAjax(record);
            }
        }
        

    function createRecordAjax(record){
        console.log(JSON.stringify(record));
        $.ajax({
            "url": "http://127.0.0.1:5000/survey",
            "method":"POST",
            "data":JSON.stringify(record),
            "dataType": "JSON",
            contentType: "application/json; charset=utf-8",
            "success":function(result){
                console.log(result);
                record.id = result.ResponseID
                document.getElementById('createForm').style.display="none";
                document.getElementById('thankyou').style.display="inline-block";
                document.getElementById('resultsStatsButtons').style.display="none";
                document.getElementById('respID').innerHTML="<h3>Your Response ID is "+record.id+".</h3><p><h5>Please take note of this ID in case you need to amend your survey response below.</h5></p><h5>Note that responses cannot be amended once you leave this page.</h5><br>";
            },
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
            }
        });
    }

        function showResults(){
            document.getElementById('thankyou').style.display="none";
            document.getElementById('deleted').style.display="none";
            document.getElementById('surveyStats').style.display="none";
            document.getElementById('createForm').style.display="none";
            document.getElementById('resultsStatsButtons').style.display="inline-block";
            document.getElementById('results').style.display="inline-block";
           
            resetTables()
            getAllAjax()
        }


        function getAllAjax(){
        $.ajax({
            "url": "http://127.0.0.1:5000/survey",
            "method":"GET",
            "data":"",
            "dataType": "JSON",
            "success":function(result){
                //console.log(result);
                for (record of result){
                    addRecordToTable(record);
                }
                
            },
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
            }
        });

    }

        function addRecordToTable(record){
            var tableElement = document.getElementById('resultsTable')
            var rowElement = tableElement.insertRow(-1)
            //rowElement.setAttribute('id',record.id)
            var cell1 = rowElement.insertCell(0);
            cell1.innerHTML = record.ResponseID
            var cell2 = rowElement.insertCell(1);
            cell2.innerHTML = record.IT_Overall_Score
            var cell3 = rowElement.insertCell(2);
            cell3.innerHTML = record.Laptop_Score
            var cell4 = rowElement.insertCell(3);
            cell4.innerHTML = record.Accessories_Score
            var cell5 = rowElement.insertCell(4);
            cell5.innerHTML = record.Applications_Score
            var cell6 = rowElement.insertCell(5);
            cell6.innerHTML = record.Support_Score
            var cell7 = rowElement.insertCell(6);
            cell7.innerHTML = record.Positive_Feedback
            var cell8 = rowElement.insertCell(7);
            cell8.innerHTML = record.Negative_Feedback
            var cell9 = rowElement.insertCell(8);
            cell9.innerHTML = record.Follow_Up

    }
    function showUpdateDelete(){
        document.getElementById('thankyou').style.display="none";
        document.getElementById('resultsStatsButtons').style.display="none";
        document.getElementById('updateDelete').style.display="inline-block";
    }

    function retrieveRecord(){
        //document.getElementById('updateDeleteTable').style.display="inline-block";
        var form = document.getElementById('updateDelete')
        respID = form.querySelector('input[name="respID"]').value
        console.log(respID)
        resetTables();
        getRecordAjax(respID);

    }

    function deleteRecord(){
        var form = document.getElementById('updateDelete')
        respID = form.querySelector('input[name="respID"]').value
        console.log(respID)
        deleteRecordAjax(respID);
    }   

    function deleteRecordAjax(respID){
        $.ajax({
            "url": "http://127.0.0.1:5000/survey/"+respID,
            "method":"DELETE",
            "data":"",
            "dataType": "JSON",
            contentType: "application/json; charset=utf-8",
            "success":function(result){
                //console.log(result);
                var tableElement = document.getElementById('resultsTable')
                tableElement.deleteRow(-1);
                document.getElementById('deleted').style.display="inline-block";
                document.getElementById('updateDelete').style.display="none";
                document.getElementById('updateDeleteButtons').style.display="none";
            },
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
            }
        });
    }

    function getRecordAjax(respID){
        $.ajax({
            "url": "http://127.0.0.1:5000/survey/"+respID,
            "method":"GET",
            "data":"",
            "dataType": "JSON",
            "success":function(result){
                console.log(result);
                document.getElementById('results').style.display="inline-block";
                addRecordToTable(result);
                document.getElementById('updateDeleteButtons').style.display="inline-block";
                document.getElementById('empID').innerHTML="Employee ID: "+result.EmployeeID+" (this cannot be amended)";
                },
                
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
                console.log(url)
            }
        });

    }

    function updateRecord(){
        document.getElementById('results').style.display="none";
        document.getElementById('updateDelete').style.display="none";
        document.getElementById('updateDeleteButtons').style.display="none";
        document.getElementById('createForm').style.display="inline-block";

        //clearing the results table and form
        var tableElement = document.getElementById('resultsTable')
        tableElement.deleteRow(-1);
        clearFormForUpdate()
    }

    function clearFormForUpdate(){
        var form = document.getElementById('createForm')
        //not allowing users to change their employee ID
        form.querySelector('input[name="employeeID"]').disabled = true

        // https://bobbyhadz.com/blog/javascript-set-radio-to-checked-unchecked
        document.getElementsByName('overallIT').checked=false;
        document.getElementsByName('laptop').checked=false;
        document.getElementsByName('accessories').checked=false;
        document.getElementsByName('apps').checked=false;
        document.getElementsByName('support').checked=false;   
        document.getElementsByName('followUp').checked=false;

        form.querySelector('textarea[name="posFeedback"]').value=''
        form.querySelector('textarea[name="negFeedback"]').value=''
        
        
    }

    function resetTables(){
        var tableElement = document.getElementById('resultsTable')
        //https://www.geeksforgeeks.org/how-to-count-number-of-rows-and-columns-in-a-table-using-jquery/
        var rowCount = $("#resultsTable tr").length;
        while (rowCount > 1) {
            tableElement.deleteRow(-1);
            rowCount--;
        }

        var tableElement = document.getElementById('scoresTable')
        var rowCount = $("#scoresTable tr").length;
        while (rowCount > 1) {
            tableElement.deleteRow(-1);
            rowCount--;
        }
        var tableElement = document.getElementById('deptsTable')
        var rowCount = $("#deptsTable tr").length;
        while (rowCount > 1) {
            tableElement.deleteRow(-1);
            rowCount--;
        }
        var tableElement = document.getElementById('laptopsTable')
        var rowCount = $("#laptopsTable tr").length;
        while (rowCount > 1) {
            tableElement.deleteRow(-1);
            rowCount--;
        }
        var tableElement = document.getElementById('fupTable')
        var rowCount = $("#fupTable tr").length;
        while (rowCount > 1) {
            tableElement.deleteRow(-1);
            rowCount--;
        }
    }

    function updateRecordAjax(record){
        console.log(JSON.stringify(record));
        $.ajax({
            "url": "http://127.0.0.1:5000/survey/"+respID,
            "method":"PUT",
            "data":JSON.stringify(record),
            "dataType": "JSON",
            contentType: "application/json; charset=utf-8",
            "success":function(result){
                // console.log(result);
                document.getElementById('createForm').style.display="none";
                document.getElementById('thankyou').style.display="inline-block";
                document.getElementById('respID').innerHTML="<h3>Your Response ID is "+respID+".</h3><p><h5>Please take note of this ID in case you need to amend your survey response below.</h5></p><h5>Note that responses cannot be amended once you leave this page.</h5><br>";
                  
            },
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
                console.log(respID);
            }
        });
    }

    function warnUser(){
        document.getElementById('warnUser').style.display="inline-block";
        document.getElementById('confirmButton').style.display="inline-block";
    }

    function showStatistics(){
        document.getElementById('thankyou').style.display="none";
        document.getElementById('deleted').style.display="none";
        document.getElementById('createForm').style.display="none";
        document.getElementById('results').style.display="none";
        document.getElementById('resultsStatsButtons').style.display="inline-block";
        document.getElementById('surveyStats').style.display="inline-block";
        resetTables();
        getStatsAjax();
    }

    function getStatsAjax(){
        $.ajax({
            "url": "http://127.0.0.1:5000/survey/stats",
            "method":"GET",
            "data":"",
            "dataType": "JSON",
            "success":function(result){
                console.log(result);
                document.getElementById('numResponses').innerHTML="Current Number of Responses: "+result[0].NumResponses;
                // eventually copped that each query result was contained within it's own index, used those to populate tables
                addScoresToTable(result[1]);

                for (record of result[2]){
                    console.log(record)
                    addDeptResponsesToTable(record);
                }

                for (record of result[3]){
                    console.log(record)
                    addLaptopResponsesToTable(record);
                }

                for (record of result[4]){
                    console.log(record)
                    addFollowUpInfoToTable(record);
                }

                
            },
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
            }
        });

    }

        function addScoresToTable(record){
            // scores table
            var table = document.getElementById('scoresTable')
            var rowElement = table.insertRow(-1)
            // https://stackoverflow.com/questions/20804163/check-if-a-key-exists-inside-a-json-object
            //if (("IT_Overall" in record)==true)
                var cell1 = rowElement.insertCell(0);
                cell1.innerHTML = record.IT_Overall
                var cell2 = rowElement.insertCell(1);
                cell2.innerHTML = record.Laptops
                var cell3 = rowElement.insertCell(2);
                cell3.innerHTML = record.Accessories
                var cell4 = rowElement.insertCell(3);
                cell4.innerHTML = record.Applications
                var cell5 = rowElement.insertCell(4);
                cell5.innerHTML = record.Support
            }
        
        function addDeptResponsesToTable(record){
            // departments table
            //if (("Dept_Responses" in record)==true)
            
                var table = document.getElementById('deptsTable')
                var rowElement = table.insertRow(-1)
                var cell1 = rowElement.insertCell(0);
                cell1.innerHTML = record.Department
                var cell2 = rowElement.insertCell(1);
                cell2.innerHTML = record.Dept_Responses   
        }

        function addLaptopResponsesToTable(record){
            // laptops table
            //if (("Negative_Scores" in record)==true)
            
                var table = document.getElementById('laptopsTable')
                var rowElement = table.insertRow(-1)
                var cell1 = rowElement.insertCell(0);
                cell1.innerHTML = record.DeviceModel
                var cell2 = rowElement.insertCell(1);
                cell2.innerHTML = record.Negative_Scores
            
        }

        function addFollowUpInfoToTable(record){
            // follow up (employee info) table
        //if (("Email" in record)==true)
            
                var table = document.getElementById('fupTable')
                var rowElement = table.insertRow(-1)
                var cell1 = rowElement.insertCell(0);
                cell1.innerHTML = record.ResponseID
                var cell2 = rowElement.insertCell(1);
                cell2.innerHTML = record.EmployeeID
                var cell3 = rowElement.insertCell(2);
                cell3.innerHTML = record.Email
                var cell4 = rowElement.insertCell(3);
                cell4.innerHTML = record.ManagerID
                var cell5 = rowElement.insertCell(4);
                cell5.innerHTML = record.Location
                var cell6 = rowElement.insertCell(5);
                cell6.innerHTML = record.JobTitle
                var cell7 = rowElement.insertCell(6);
                cell7.innerHTML = record.Dept
                var cell8 = rowElement.insertCell(7);
                cell8.innerHTML = record.LaptopModel
                var cell9 = rowElement.insertCell(8);
                cell9.innerHTML = record.LaptopAgeMths
                var cell10 = rowElement.insertCell(9);
                cell10.innerHTML = record.FollowUp
                var cell11 = rowElement.insertCell(10);
                cell11.innerHTML = record.ITOverall
                var cell12 = rowElement.insertCell(11);
                cell12.innerHTML = record.LaptopScore
                var cell13 = rowElement.insertCell(12);
                cell13.innerHTML = record.AccessoriesScore
                var cell14 = rowElement.insertCell(13);
                cell14.innerHTML = record.AppsScore
                var cell15 = rowElement.insertCell(14);
                cell15.innerHTML = record.SupportScore
            }
        
    


    </script>

</html>